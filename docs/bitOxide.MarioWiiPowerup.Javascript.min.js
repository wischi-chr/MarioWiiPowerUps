Bridge.assembly("bitOxide.MarioWiiPowerup.Javascript",function(){"use strict";Bridge.define("bitOxide.MarioWiiPowerup.Core.Board",{statics:{methods:{AreBoardItemsValid:function(items){return items==null||items.length!==bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard?!1:System.Linq.Enumerable.from(items).count(function(i){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(i,bitOxide.MarioWiiPowerup.Core.Item.Bowser)})!==2?!1:System.Linq.Enumerable.from(items).count(function(i){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(i,bitOxide.MarioWiiPowerup.Core.Item.MiniBowser)})!==2?!1:System.Linq.Enumerable.from(items).distinct().all(function(i){return System.Linq.Enumerable.from(items).count(function(si){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(si,i)})%2==0})}}},fields:{items:null},ctors:{ctor:function(items){if(items===void 0&&(items=[]),this.$initialize(),!bitOxide.MarioWiiPowerup.Core.Board.AreBoardItemsValid(items))throw new System.ArgumentException;this.items=Bridge.cast(System.Array.clone(items),System.Array.type(bitOxide.MarioWiiPowerup.Core.Item))}},methods:{getItem:function(index){if(index<0||index>=bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard)throw new System.IndexOutOfRangeException;return this.items[System.Array.index(index,this.items)]}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.BoardExtensions",{statics:{methods:{Matches:function(b,filter){if(filter==null)throw new System.ArgumentNullException;if(filter.length!==bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard)throw new System.ArgumentException;for(var i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)if(!bitOxide.MarioWiiPowerup.Core.Item.op_Equality(filter[System.Array.index(i,filter)],null)&&bitOxide.MarioWiiPowerup.Core.Item.op_Inequality(b.getItem(i),filter[System.Array.index(i,filter)]))return!1;return!0}}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Item",{statics:{fields:{IceFlower:null,FireFlower:null,Fly:null,Mushroom:null,Mini:null,Star:null,Penguin:null,Bowser:null,MiniBowser:null},ctors:{init:function(){this.IceFlower=new bitOxide.MarioWiiPowerup.Core.Item("IceFlower",!1);this.FireFlower=new bitOxide.MarioWiiPowerup.Core.Item("FireFlower",!1);this.Fly=new bitOxide.MarioWiiPowerup.Core.Item("Fly",!1);this.Mushroom=new bitOxide.MarioWiiPowerup.Core.Item("Mushroom",!1);this.Mini=new bitOxide.MarioWiiPowerup.Core.Item("Mini",!1);this.Star=new bitOxide.MarioWiiPowerup.Core.Item("Star",!1);this.Penguin=new bitOxide.MarioWiiPowerup.Core.Item("Penguin",!1);this.Bowser=new bitOxide.MarioWiiPowerup.Core.Item("Bowser",!0);this.MiniBowser=new bitOxide.MarioWiiPowerup.Core.Item("MiniBowser",!0)}},methods:{op_Equality:function(a,b){return Bridge.referenceEquals(a,b)?!0:Bridge.referenceEquals(a,null)||Bridge.referenceEquals(b,null)?!1:Bridge.referenceEquals(a.Name,b.Name)},op_Inequality:function(a,b){return!bitOxide.MarioWiiPowerup.Core.Item.op_Equality(a,b)}}},fields:{Name:null,IsBad:!1},ctors:{ctor:function(Name,IsBad){this.$initialize();this.Name=Name;this.IsBad=IsBad}},methods:{equals:function(obj){var b=Bridge.as(obj,bitOxide.MarioWiiPowerup.Core.Item);return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(this,b)},toString:function(){return this.Name},getHashCode:function(){return Bridge.getHashCode(this.Name)}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.ItemBoard");Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions",{statics:{methods:{GetInformationContent:function(boards){for(var infos=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Double),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)infos[System.Array.index(i,infos)]=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInformationContentFromBoard(boards,i);return infos},GetInformationContentFromBoard:function(boards,position){return bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInformationContentFromList(Bridge.global.bitOxide.MarioWiiPowerup.Core.Item,System.Linq.Enumerable.from(boards).select(function(b){return b.getItem(position)}))},GetInformationContentFromList:function(T,elements){var $t,$t1,itemCounter=new(System.Collections.Generic.Dictionary$2(T,System.Int32)),cnt=0,e,infoSum;$t=Bridge.getEnumerator(elements,T);try{while($t.moveNext())e=$t.Current,itemCounter.containsKey(e)||itemCounter.add(e,0),itemCounter.set(e,itemCounter.get(e)+1|0),cnt=cnt+1|0}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}infoSum=0;$t1=Bridge.getEnumerator(itemCounter);try{while($t1.moveNext()){var i=$t1.Current,px=i.value/cnt,info=-Bridge.Math.logWithBase(px,2);infoSum+=info*i.value}}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$dispose()}return infoSum},GetDiversityScore:function(boards){for(var b,i1,maxDup,$t,cntBoards=0,cntDuplicates=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Int32),items=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,null,System.Collections.Generic.List$1(bitOxide.MarioWiiPowerup.Core.Item)),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)items[System.Array.index(i,items)]=new(System.Collections.Generic.List$1(bitOxide.MarioWiiPowerup.Core.Item).ctor);$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,cntBoards=cntBoards+1|0,i1=0;i1<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i1=i1+1|0)items[System.Array.index(i1,items)].contains(b.getItem(i1))?cntDuplicates[System.Array.index(i1,cntDuplicates)]=cntDuplicates[System.Array.index(i1,cntDuplicates)]+1|0:items[System.Array.index(i1,items)].add(b.getItem(i1))}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return maxDup=System.Linq.Enumerable.from(cntDuplicates).max(),maxDup===0?System.Linq.Enumerable.range(0,bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard).select(function(){return 1}).toArray(System.Double):System.Linq.Enumerable.from(cntDuplicates).select(function(d){return 1-d/maxDup}).toArray(System.Double)},GetInstantLoseScore:function(boards,filledItems){for(var noSmall,noLarge,b,i1,$t,res=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Double),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)res[System.Array.index(i,res)]=1;noSmall=System.Linq.Enumerable.from(filledItems).where(function(x){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(x,bitOxide.MarioWiiPowerup.Core.Item.MiniBowser)}).count()>0;noLarge=System.Linq.Enumerable.from(filledItems).where(function(x){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(x,bitOxide.MarioWiiPowerup.Core.Item.Bowser)}).count()>0;$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,i1=0;i1<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i1=i1+1|0)bitOxide.MarioWiiPowerup.Core.Item.op_Equality(b.getItem(i1),bitOxide.MarioWiiPowerup.Core.Item.Bowser)&&noLarge?res[System.Array.index(i1,res)]=0:bitOxide.MarioWiiPowerup.Core.Item.op_Equality(b.getItem(i1),bitOxide.MarioWiiPowerup.Core.Item.MiniBowser)&&noSmall&&(res[System.Array.index(i1,res)]=0)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return res},GetGoodPositionScore:function(boards){var $t,cntBoards=0,cntBowsers=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Int32),b,i;$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,cntBoards=cntBoards+1|0,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)b.getItem(i).IsBad&&(cntBowsers[System.Array.index(i,cntBowsers)]=cntBowsers[System.Array.index(i,cntBowsers)]+1|0)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return System.Linq.Enumerable.from(cntBowsers).select(function(i1){return(cntBoards-i1|0)/cntBoards}).toArray(System.Double)},GetDistanceFactors:function(position){var res=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Double),i,inputY,inputX,i1;if(!System.Nullable.hasValue(position)){for(i=0;i<res.length;i=i+1|0)res[System.Array.index(i,res)]=1;return res}for(inputY=Bridge.Int.div(System.Nullable.getValue(position),6)|0,inputX=System.Nullable.getValue(position)%6,i1=0;i1<res.length;i1=i1+1|0){var y=Bridge.Int.div(i1,6)|0,x=i1%6,distance=Math.abs(x-inputX|0)+Math.abs(y-inputY|0)|0;res[System.Array.index(i1,res)]=1-distance*.0001}return res},GetBowserFieldPenalty:function(boards){var $t,cntBoards=0,cntBowsers=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Int32),b,i;$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,cntBoards=cntBoards+1|0,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)b.getItem(i).IsBad&&(cntBowsers[System.Array.index(i,cntBowsers)]=cntBowsers[System.Array.index(i,cntBowsers)]+1|0)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return System.Linq.Enumerable.from(cntBowsers).select(function(i1){return i1>0?.95:1}).toArray(System.Double)},GetBowserFieldPenalty2:function(boards){var $t,cntBoards=0,cntBowsers=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Int32),b,i,bowserMin,bowserDelta;$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,cntBoards=cntBoards+1|0,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)b.getItem(i).IsBad&&(cntBowsers[System.Array.index(i,cntBowsers)]=cntBowsers[System.Array.index(i,cntBowsers)]+1|0)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return(bowserMin=System.Linq.Enumerable.from(cntBowsers).min(),bowserDelta=System.Linq.Enumerable.from(cntBowsers).max()-bowserMin|0,bowserMin===0)?System.Linq.Enumerable.from(cntBowsers).select(function(bCnt){return bCnt===0?1:0}).toArray(System.Double):System.Linq.Enumerable.from(cntBowsers).select(function(bCnt){return(1-(bCnt-bowserMin|0)/bowserDelta)*.8+.1}).toArray(System.Double)},DiscardBowserFieldScore:function(boards){var $t,cntBoards=0,cntBowsers=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Int32),b,i;$t=Bridge.getEnumerator(boards,bitOxide.MarioWiiPowerup.Core.Board);try{while($t.moveNext())for(b=$t.Current,cntBoards=cntBoards+1|0,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)b.getItem(i).IsBad&&(cntBowsers[System.Array.index(i,cntBowsers)]=cntBowsers[System.Array.index(i,cntBowsers)]+1|0)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return System.Linq.Enumerable.from(cntBowsers).select(function(i1){return i1>0?0:1}).toArray(System.Double)},GetNonOpenPositions:function(filledItems){for(var nop=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Double),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)nop[System.Array.index(i,nop)]=bitOxide.MarioWiiPowerup.Core.Item.op_Inequality(filledItems[System.Array.index(i,filledItems)],null)?0:1;return nop},MergeScores:function(props){var $t,res,i,p,i1;for(props===void 0&&(props=[]),res=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,0,System.Double),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)res[System.Array.index(i,res)]=1;$t=Bridge.getEnumerator(props);try{while($t.moveNext()){if(p=$t.Current,p.length!==bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard)throw new System.ArgumentOutOfRangeException;for(i1=0;i1<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i1=i1+1|0)res[System.Array.index(i1,res)]*=p[System.Array.index(i1,p)]}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return res}}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.ISuggestionStrategy",{$kind:"interface"});Bridge.define("bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards",{statics:{fields:{global:null},props:{DefaultBoardSet:{get:function(){return bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards.global}}},ctors:{init:function(){this.global=bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards.LoadGlobalBoardCollection()}},methods:{LoadRawBoardInfos:function(){return System.Linq.Enumerable.from("IfFMBbMIfBIfFbIfFFbIFFffFBfMIbIfMBFIbfFMSfMIFBISFbIBFIffIFBfFBFMIbIbMfFIIIFFfbMBFBFSISMfbIfIIMBfFIfMFbFfIBbFmffmSfSFBImbmBFbIffmfmbfBFfImbIFFmBFbfFFffmIfImmmBFbBFbmFFfBmIBIbmIffmIfmfBISfBIfmbbmSFmfFfmBIbBmFfImmIffbIFbBBmSpFppIbmIpffSFImBpmpFmmFpBpbFFbISBpfbpmmpFbBIpfFSIImppmIIBmFbBppFmbIbBBmmpFpmFpmIbFFpIImBmbIImpIpBpbFmpFBfFfbpfbImfIBmFSpSbppfbpmFmmIIBBfFmppfFFmpmbmBIbpmfIpBBpFfmpmbIBfbpmIFmpbfpfSffFmBIIpBFbmSpppFbfmFmmfIpBIbmBIpFISIfBbSBbIpfFmmIfFmBIIBbpFfFpbImFImFmpfIBIpFbFBbfIFBmFIpfffIbBbIpfFImBmbIpfISISFbIBmfpFBfbmBfIfIbFfIpmIpFBSIfBFFSFbbFmIppfmBbmfFbmFFIFpmIpBfmBbIpFfFBIIbFmFpIfmfFmfpFmSISbpIFBBFbfFmpBfmFIIbFIIBpFbfmFfpbmBIbFpmFBIFmfBbIIffSmpBSFbfmFpfFbImmBbIpBmpffmFfBFbfIfBSfpIbFfpmSmfBffmmBmImIbFfpFbpBFfIImfmmmBbpfpFbfBBfImffbmpImFbfmFpmpBbmIfFSSBbmIfFmpFBfbIpIbBpmFmIfIFFFpfBmImFIpBbIfbIFFFBfBIpIbIpmbmIfFFFmpBSmpmbBSmbIffIFFmBfbIImFIpBFIfbFFpbSfFSSBfImSFbIpBmppSbFmfSBbIBmFIpSfSpIfSBSBfImFFbbSSmppIbSmfSfbIBFFSpBmSbIpFBfSBImSmFbSSfppIfFSfSBbISmFbpBmS").toArray()},LoadGlobalBoardCollection:function(){var itemCnt=0,itemRawSource=bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards.LoadRawBoardInfos(),worlds,world,boards,board,items,item;if(itemRawSource.length!==972)throw new System.NotSupportedException;for(worlds=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.WorldCount,null,bitOxide.MarioWiiPowerup.Core.WorldBoardCollection),world=0;world<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.WorldCount;world=world+1|0){for(boards=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.BoardsPerWorld,null,bitOxide.MarioWiiPowerup.Core.Board),board=0;board<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.BoardsPerWorld;board=board+1|0){for(items=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,null,bitOxide.MarioWiiPowerup.Core.Item),item=0;item<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;item=item+1|0)items[System.Array.index(item,items)]=bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards.GetItemFromChar(itemRawSource[System.Array.index(Bridge.identity(itemCnt,itemCnt=itemCnt+1|0),itemRawSource)]);boards[System.Array.index(board,boards)]=new bitOxide.MarioWiiPowerup.Core.Board(items)}worlds[System.Array.index(world,worlds)]=new bitOxide.MarioWiiPowerup.Core.WorldBoardCollection(boards)}return new bitOxide.MarioWiiPowerup.Core.GlobalBoardCollection(worlds)},GetItemFromChar:function(c){switch(c){case 73:return bitOxide.MarioWiiPowerup.Core.Item.IceFlower;case 70:return bitOxide.MarioWiiPowerup.Core.Item.FireFlower;case 83:return bitOxide.MarioWiiPowerup.Core.Item.Star;case 109:return bitOxide.MarioWiiPowerup.Core.Item.Mini;case 66:return bitOxide.MarioWiiPowerup.Core.Item.Bowser;case 98:return bitOxide.MarioWiiPowerup.Core.Item.MiniBowser;case 102:return bitOxide.MarioWiiPowerup.Core.Item.Fly;case 112:return bitOxide.MarioWiiPowerup.Core.Item.Penguin;case 77:return bitOxide.MarioWiiPowerup.Core.Item.Mushroom}throw new System.NotSupportedException;}}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants",{statics:{fields:{WorldCount:0,BoardsPerWorld:0,ItemsPerBoard:0,BoardsInTotal:0},ctors:{init:function(){this.WorldCount=9;this.BoardsPerWorld=6;this.ItemsPerBoard=18;this.BoardsInTotal=54}}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.ViewModel.MainPanel",{statics:{methods:{AllSameOrDefault:function(T,elements,fallback){var res=System.Linq.Enumerable.from(elements).distinct().take(2).toList(T);return res.Count===1?res.getItem(0):res.Count===2&&Bridge.equals(res.getItem(0),res.getItem(1))?res.getItem(0):fallback}}},fields:{itemInformations:null,allBoards:null,focusedItem:0,noBowserInPosition:null,derivedItems:null,isPositionBad:null,winOnNextDecision:null,itemsInFocusedPosition:null,strat:null,itemHistory:null,currentSolution:null,MatchingBoardCount:0},props:{SolvedBoard:{get:function(){return this.currentSolution}},FocusedPositionId:{get:function(){return this.focusedItem}}},ctors:{init:function(){this.itemInformations=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,null,bitOxide.MarioWiiPowerup.Core.Item);this.allBoards=System.Linq.Enumerable.from(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiBoards.DefaultBoardSet.AllBoards).toArray();this.focusedItem=0;this.noBowserInPosition=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,!1,System.Boolean);this.derivedItems=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,null,bitOxide.MarioWiiPowerup.Core.Item);this.isPositionBad=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,!1,System.Boolean);this.winOnNextDecision=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,!1,System.Boolean);this.itemsInFocusedPosition=new(System.Collections.Generic.HashSet$1(bitOxide.MarioWiiPowerup.Core.Item).ctor);this.strat=new bitOxide.MarioWiiPowerup.Core.Strategies.FindSolutionWithLeastInputs4;this.itemHistory=new(System.Collections.Generic.List$1(System.Array.type(bitOxide.MarioWiiPowerup.Core.Item)).ctor)},ctor:function(){this.$initialize()}},methods:{IsItemInFocusedPosition:function(item){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(item,null)?!1:this.itemsInFocusedPosition.contains(item)},GetDerivedItem:function(pos){return this.derivedItems[System.Array.index(pos,this.derivedItems)]},IsWinningPosition:function(pos){return this.winOnNextDecision[System.Array.index(pos,this.winOnNextDecision)]},IsPositionBad:function(pos){return this.isPositionBad[System.Array.index(pos,this.isPositionBad)]},IsPositionSafe:function(pos){return this.noBowserInPosition[System.Array.index(pos,this.noBowserInPosition)]},GetItemFromPosition:function(pos){return this.itemInformations[System.Array.index(pos,this.itemInformations)]},SaveCurrentStateAsHistory:function(){for(var entry=System.Array.init(bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard,null,bitOxide.MarioWiiPowerup.Core.Item),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)entry[System.Array.index(i,entry)]=this.itemInformations[System.Array.index(i,this.itemInformations)];this.itemHistory.removeAll(function(x){return System.Linq.Enumerable.from(entry).sequenceEqual(x)});this.itemHistory.add(entry)},RestoreHistoryState:function(){var lastEntry,i;if(!(this.itemHistory.Count<1))for(lastEntry=this.itemHistory.getItem(this.itemHistory.Count-1|0),this.itemHistory.removeAt(this.itemHistory.Count-1|0),i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)this.itemInformations[System.Array.index(i,this.itemInformations)]=lastEntry[System.Array.index(i,lastEntry)]},ResetBoardInfos:function(){for(var i=0;i<this.itemInformations.length;i=i+1|0)this.itemInformations[System.Array.index(i,this.itemInformations)]=null;this.itemHistory.clear();this.RecalcAll()},RemoveFocusedItem:function(){this.RestoreHistoryState();this.RecalcAll()},FocusBestPosition:function(){var res=this.strat.bitOxide$MarioWiiPowerup$Core$Strategies$ISuggestionStrategy$SuggestNextItemPosition(this.allBoards,this.itemInformations,this.focusedItem);if(res==null){this.RecalcAllowedItems();return}this.FocusPosition(System.Nullable.getValue(res))},FocusPosition:function(pos){if(pos<0||pos>=bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard)throw new System.IndexOutOfRangeException;this.focusedItem=pos;this.RecalcAllowedItems()},ClickItem:function(item){this.SaveCurrentStateAsHistory();this.itemInformations[System.Array.index(this.focusedItem,this.itemInformations)]=item;this.RecalcAll()},RecalcAllowedItems:function(){var items=Bridge.cast(System.Array.clone(this.itemInformations),System.Array.type(bitOxide.MarioWiiPowerup.Core.Item));items[System.Array.index(this.focusedItem,items)]=null;this.RecalcAllowedItems$1(this.itemsInFocusedPosition,items,this.focusedItem)},RecalcAllowedItems$1:function(allowedItemBuffer,currentItemState,position){var $t,items,allMatchingBoards,b,i;if(System.Array.clear(allowedItemBuffer,bitOxide.MarioWiiPowerup.Core.Item),items=Bridge.cast(System.Array.clone(this.itemInformations),System.Array.type(bitOxide.MarioWiiPowerup.Core.Item)),items[System.Array.index(this.focusedItem,items)]=null,allMatchingBoards=System.Linq.Enumerable.from(this.allBoards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,currentItemState)}).toArray(bitOxide.MarioWiiPowerup.Core.Board),allMatchingBoards.length>1){$t=Bridge.getEnumerator(allMatchingBoards);try{while($t.moveNext())for(b=$t.Current,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)i===position&&allowedItemBuffer.System$Collections$Generic$ISet$1$bitOxide$MarioWiiPowerup$Core$Item$add(b.getItem(i))}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}}},IsSingleResultConfig:function(itemConfiguration){return System.Linq.Enumerable.from(this.allBoards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,itemConfiguration)}).take(2).count()===1},RecalcAll:function(reposition){reposition===void 0&&(reposition=!0);this.FindPossibleSolutionsAndSafeSpots();reposition&&this.FocusBestPosition()},FindPossibleSolutionsAndSafeSpots:function(){var $t,allMatchingBoards=System.Linq.Enumerable.from(this.allBoards).where(Bridge.fn.bind(this,function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,this.itemInformations)})).toArray(bitOxide.MarioWiiPowerup.Core.Board),i,winTempItemInfo,winTempSet,i1,b,i2,i3;for(this.MatchingBoardCount=allMatchingBoards.length,this.currentSolution=allMatchingBoards.length===1?allMatchingBoards[System.Array.index(0,allMatchingBoards)]:null,i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)this.derivedItems[System.Array.index(i,this.derivedItems)]=null,this.isPositionBad[System.Array.index(i,this.isPositionBad)]=!1,this.winOnNextDecision[System.Array.index(i,this.winOnNextDecision)]=!1;if(winTempItemInfo=System.Array.init(this.itemInformations.length,null,bitOxide.MarioWiiPowerup.Core.Item),winTempSet=new(System.Collections.Generic.HashSet$1(bitOxide.MarioWiiPowerup.Core.Item).ctor),allMatchingBoards.length>0){for(i1=0;i1<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i1=i1+1|0)this.noBowserInPosition[System.Array.index(i1,this.noBowserInPosition)]=!0,this.derivedItems[System.Array.index(i1,this.derivedItems)]=bitOxide.MarioWiiPowerup.Core.ViewModel.MainPanel.AllSameOrDefault(Bridge.global.bitOxide.MarioWiiPowerup.Core.Item,System.Linq.Enumerable.from(allMatchingBoards).select(function(b){return b.getItem(i1)}),null),this.isPositionBad[System.Array.index(i1,this.isPositionBad)]=bitOxide.MarioWiiPowerup.Core.ViewModel.MainPanel.AllSameOrDefault(System.Boolean,System.Linq.Enumerable.from(allMatchingBoards).select(function(b){return b.getItem(i1).IsBad}),!1),System.Array.copy(this.itemInformations,0,winTempItemInfo,0,this.itemInformations.length),this.RecalcAllowedItems$1(winTempSet,winTempItemInfo,i1),this.winOnNextDecision[System.Array.index(i1,this.winOnNextDecision)]=System.Linq.Enumerable.from(winTempSet).all(Bridge.fn.bind(this,function(item){return winTempItemInfo[System.Array.index(i1,winTempItemInfo)]=item,this.IsSingleResultConfig(winTempItemInfo)}));$t=Bridge.getEnumerator(allMatchingBoards);try{while($t.moveNext())for(b=$t.Current,i2=0;i2<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i2=i2+1|0)b.getItem(i2).IsBad&&(this.noBowserInPosition[System.Array.index(i2,this.noBowserInPosition)]=!1)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}}else for(i3=0;i3<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i3=i3+1|0)this.noBowserInPosition[System.Array.index(i3,this.noBowserInPosition)]=!1}}});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.App",{statics:{fields:{bgImageWidth:0,bgImageHeight:0,iconMargin:0,iconSize:0,distA:0,distB:0,realWidth:0,realHeight:0},ctors:{init:function(){this.bgImageWidth=1375;this.bgImageHeight=500;this.iconMargin=.1;this.iconSize=.8;this.distA=.25;this.distB=.5;this.realWidth=11.25;this.realHeight=5.25}}},fields:{canvasScreen:null,ctx:null,itemImages:null,panelViewModel:null,bgImage:null,toad:null,helpActive:!1,itemButtons:null,actionIcons:null,offsetLeft:0,offsetTop:0,boxScale:0,devicePixelRatio:0,scaleBg:0,offsetLeftBg:0,offsetTopBg:0,offsetBoardLeftCols:0,borderColorDefault:null,borderColorSet:null,borderColorFocus:null,borderColorSafeSpot:null,backgroundColorSafeSpot:null,borderColorAction:null},ctors:{init:function(){this.itemImages=bitOxide.MarioWiiPowerup.Javascript.ItemImageStore.GetDefault();this.panelViewModel=new bitOxide.MarioWiiPowerup.Core.ViewModel.MainPanel;this.helpActive=!1;this.itemButtons=System.Array.init([bitOxide.MarioWiiPowerup.Core.Item.Fly,bitOxide.MarioWiiPowerup.Core.Item.IceFlower,bitOxide.MarioWiiPowerup.Core.Item.FireFlower,bitOxide.MarioWiiPowerup.Core.Item.Mini,bitOxide.MarioWiiPowerup.Core.Item.Penguin,bitOxide.MarioWiiPowerup.Core.Item.Star,bitOxide.MarioWiiPowerup.Core.Item.Mushroom,bitOxide.MarioWiiPowerup.Core.Item.MiniBowser,bitOxide.MarioWiiPowerup.Core.Item.Bowser],bitOxide.MarioWiiPowerup.Core.Item);this.actionIcons=System.Array.init(["pow","bullet","question"],System.String);this.offsetLeft=30;this.offsetTop=30;this.boxScale=167;this.devicePixelRatio=0;this.scaleBg=0;this.offsetLeftBg=0;this.offsetTopBg=0;this.offsetBoardLeftCols=1;this.borderColorDefault="#ADD8E6";this.borderColorSet="#191970";this.borderColorFocus="#3a316f";this.borderColorSafeSpot="#7f77ae";this.backgroundColorSafeSpot="#7f77ae";this.borderColorAction="#FFF"},ctor:function(screen){var $t;this.$initialize();this.canvasScreen=screen;this.ctx=screen.getContext("2d");this.ctx.imageSmoothingEnabled=!0;this.bgImage=($t=new Image,$t.src="img/bg.png",$t);this.toad=($t=new Image,$t.src="img/toad.png",$t);screen.addEventListener("click",Bridge.fn.cacheBind(this,this.Clicked));this.panelViewModel.FocusBestPosition()}},methods:{Clicked:function(e){var c,posId;if(Bridge.is(e,MouseEvent)){var me=Bridge.cast(e,MouseEvent),col={},row={},colHit={},rowHit={};this.HitScan(me.clientX*this.devicePixelRatio,me.clientY*this.devicePixelRatio,col,row,colHit,rowHit);rowHit.v&&colHit.v&&(col.v===8&&row.v>=0&&row.v<=2?row.v===0?this.helpActive||this.panelViewModel.ResetBoardInfos():row.v===1?this.helpActive||this.panelViewModel.RemoveFocusedItem():this.helpActive=!this.helpActive:col.v>=this.offsetBoardLeftCols&&col.v<=(5+this.offsetBoardLeftCols|0)&&row.v>=0&&row.v<=2?this.helpActive||(c=col.v-this.offsetBoardLeftCols|0,posId=Bridge.Int.mul(row.v,6)+c|0,this.panelViewModel.FocusPosition(posId)):row.v===3&&(this.helpActive||this.panelViewModel.ClickItem(this.itemButtons[System.Array.index(col.v,this.itemButtons)])),this.Draw())}},HitScan:function(clientX,clientY,column,row,colHit,rowHit){var row1start=this.offsetTop,row1end=row1start+this.boxScale,row2start=row1end+bitOxide.MarioWiiPowerup.Javascript.App.distA*this.boxScale,row2end=row2start+this.boxScale,row3start=row2end+bitOxide.MarioWiiPowerup.Javascript.App.distA*this.boxScale,row3end=row3start+this.boxScale,row4start=row3end+bitOxide.MarioWiiPowerup.Javascript.App.distB*this.boxScale,row4end=row4start+this.boxScale,y,colStart,colEnd;for(row.v=0,rowHit.v=!1,column.v=0,colHit.v=!1,clientY>=row1start&&clientY<=row1end?(row.v=0,rowHit.v=!0):clientY>=row2start&&clientY<=row2end?(row.v=1,rowHit.v=!0):clientY>=row3start&&clientY<=row3end?(row.v=2,rowHit.v=!0):clientY>=row4start&&clientY<=row4end&&(row.v=3,rowHit.v=!0),y=0;y<9;y=y+1|0)if(colStart=this.offsetLeft+y*1.25*this.boxScale,colEnd=colStart+this.boxScale,clientX>=colStart&&clientX<=colEnd){column.v=y;colHit.v=!0;return}},ResizeCalc:function(){var devPx=0,bgScaleX,bgScaleY;devPx=window.devicePixelRatio;this.devicePixelRatio=devPx;var scaleX=window.innerWidth/bitOxide.MarioWiiPowerup.Javascript.App.realWidth,scaleY=window.innerHeight/bitOxide.MarioWiiPowerup.Javascript.App.realHeight,baseScale=Math.min(scaleX,scaleY);this.boxScale=baseScale*this.devicePixelRatio;this.canvasScreen.width=Bridge.Int.clip32(Bridge.Math.round(window.innerWidth*this.devicePixelRatio,0,6));this.canvasScreen.height=Bridge.Int.clip32(Bridge.Math.round(window.innerHeight*this.devicePixelRatio,0,6));bgScaleX=this.canvasScreen.width/bitOxide.MarioWiiPowerup.Javascript.App.bgImageWidth;bgScaleY=this.canvasScreen.height/bitOxide.MarioWiiPowerup.Javascript.App.bgImageHeight;this.scaleBg=Math.max(bgScaleX,bgScaleY);this.offsetLeftBg=(this.canvasScreen.width-this.scaleBg*bitOxide.MarioWiiPowerup.Javascript.App.bgImageWidth)/2;this.offsetTopBg=(this.canvasScreen.height-this.scaleBg*bitOxide.MarioWiiPowerup.Javascript.App.bgImageHeight)/2;this.offsetTop=(this.canvasScreen.height-this.boxScale*bitOxide.MarioWiiPowerup.Javascript.App.realHeight)/2+.125*this.boxScale;this.offsetLeft=(this.canvasScreen.width-this.boxScale*bitOxide.MarioWiiPowerup.Javascript.App.realWidth)/2+.125*this.boxScale;this.canvasScreen.style.width=(Bridge.toString(window.innerWidth)||"")+"px";this.canvasScreen.style.height=(Bridge.toString(window.innerHeight)||"")+"px"},Draw:function(){if(!this.itemImages.LoadCompleted||!this.bgImage.complete||!this.toad.complete){window.setTimeout(Bridge.fn.cacheBind(this,this.Draw),50);return}this.ctx.save();this.ctx.globalAlpha=1;this.ctx.fillStyle="white";this.ctx.fillRect(0,0,this.canvasScreen.width,this.canvasScreen.height);this.ctx.save();this.ctx.globalAlpha=.6;this.ctx.drawImage(this.bgImage,this.offsetLeftBg,this.offsetTopBg,this.bgImage.width*this.scaleBg,this.bgImage.height*this.scaleBg);this.ctx.globalAlpha=1;this.ctx.restore();this.ctx.resetTransform();this.ctx.translate(this.offsetLeft,this.offsetTop);this.ctx.scale(this.boxScale,this.boxScale);this.DrawBoard();this.ctx.restore()},DrawNumberOfSolutions:function(){this.ctx.save();this.ctx.translate(.1,.4);this.ctx.font=System.String.format("0.4px Arial",null);this.ctx.fillStyle="#000";this.ctx.fillText(System.String.format("Panels: {0}",[Bridge.box(2,System.Int32)]),0,0);this.ctx.restore()},DrawBoard:function(){var y,x,x1,y1,y2;this.ctx.save();var distFactor=1.25,solved=this.panelViewModel.SolvedBoard,noMatches=this.panelViewModel.MatchingBoardCount<1;for(y=0;y<3;y=y+1|0)for(x=0;x<6;x=x+1|0){var posId=Bridge.Int.mul(y,6)+x|0,focused=this.panelViewModel.FocusedPositionId===posId,icon=this.itemImages.GetIcon(this.panelViewModel.GetItemFromPosition(posId)),iconWasSet=icon!=null,colorSafeSpot=this.panelViewModel.IsPositionSafe(posId)&&!iconWasSet&&solved==null,color=this.borderColorDefault,knownBad=this.panelViewModel.IsPositionBad(posId),isWinPosition=this.panelViewModel.IsWinningPosition(posId);icon==null&&(solved!=null?icon=this.itemImages.GetIcon(solved.getItem(posId)):(icon=this.itemImages.GetIcon(this.panelViewModel.GetDerivedItem(posId)),icon!=null&&(colorSafeSpot=!1)));icon==null&&isWinPosition&&colorSafeSpot&&(icon=this.itemImages.GetIcon$1("win"));focused?color=this.borderColorFocus:colorSafeSpot&&(color=this.borderColorSafeSpot);this.ctx.save();this.ctx.translate((this.offsetBoardLeftCols+x|0)*distFactor,y*distFactor);this.DrawButton(icon,color,iconWasSet?1:.7,noMatches,!1,colorSafeSpot,focused,knownBad,!1);this.ctx.restore()}for(x1=0;x1<9;x1=x1+1|0){this.ctx.save();this.ctx.translate(x1*distFactor,4);var item=this.itemButtons[System.Array.index(x1,this.itemButtons)],isRelevantItem=this.panelViewModel.IsItemInFocusedPosition(item),alpha=isRelevantItem?1:.2;this.DrawButton(this.itemImages.GetIcon(item),null,alpha,!1,!1,!1,!1,!1,!isRelevantItem);this.ctx.restore()}for(y1=0;y1<2;y1=y1+1|0)this.ctx.save(),this.ctx.translate(8*distFactor,y1*distFactor),this.DrawButton(this.itemImages.GetIcon$1(this.actionIcons[System.Array.index(y1,this.actionIcons)]),null,1,!1,!0,!1,!1,!1,!1),this.ctx.restore();this.helpActive&&this.DrawHelpOverlay();y2=2;this.ctx.save();this.ctx.translate(8*distFactor,y2*distFactor);this.DrawButton(this.itemImages.GetIcon$1(this.actionIcons[System.Array.index(y2,this.actionIcons)]),null,1,!1,!0,!1,!1,!1,!1);this.ctx.restore();this.ctx.restore()},DrawButton:function(img,borderColor,alpha,bw,whitebghide,isSafeSpot,isSelected,forceBgBlack,preventBgBlack){var drawBlack,bc;alpha===void 0&&(alpha=1);bw===void 0&&(bw=!1);whitebghide===void 0&&(whitebghide=!1);isSafeSpot===void 0&&(isSafeSpot=!1);isSelected===void 0&&(isSelected=!1);forceBgBlack===void 0&&(forceBgBlack=!1);preventBgBlack===void 0&&(preventBgBlack=!1);drawBlack=(img!=null&&img.BlackBackground||forceBgBlack)&&!preventBgBlack;drawBlack?this.DrawButtonFill("black"):whitebghide||(this.ctx.save(),this.ctx.globalAlpha=.5,isSafeSpot?this.DrawButtonFill(this.backgroundColorSafeSpot):this.DrawButtonFill("white"),this.ctx.globalAlpha=1,this.ctx.restore());this.ctx.save();this.ctx.translate(bitOxide.MarioWiiPowerup.Javascript.App.iconMargin,bitOxide.MarioWiiPowerup.Javascript.App.iconMargin);this.ctx.scale(bitOxide.MarioWiiPowerup.Javascript.App.iconSize,bitOxide.MarioWiiPowerup.Javascript.App.iconSize);this.ctx.globalAlpha=alpha;this.DrawImage(img,bw);this.ctx.restore();bc=borderColor;bw&&img!=null&&(this.ctx.save(),this.ctx.globalAlpha=1,this.ctx.globalCompositeOperation="saturation",this.ctx.fillStyle="white",bitOxide.MarioWiiPowerup.Javascript.CanvasContextExtension.RoundedRectPath(this.ctx,0,0,1,1,.2),this.ctx.fill(),this.ctx.restore());this.DrawButtonBorder(bc)},DrawHelpOverlay:function(){var width,height,oT,oL,fontsize,i;this.ctx.save();this.ctx.save();this.ctx.resetTransform();this.ctx.fillStyle="white";this.ctx.globalAlpha=.5;this.ctx.fillRect(0,0,this.canvasScreen.width,this.canvasScreen.height);this.ctx.restore();width=1;height=width/194*300;this.ctx.drawImage(this.toad,0,0,width,height);oT=this.offsetTop/this.boxScale;oL=this.offsetLeft/this.boxScale;bitOxide.MarioWiiPowerup.Javascript.CanvasContextExtension.RoundedRectPath(this.ctx,1.25,0,8.5,3.5,.2);this.ctx.globalAlpha=1;this.ctx.fillStyle="white";this.ctx.fill();this.ctx.lineWidth=.05;this.ctx.strokeStyle="black";this.ctx.stroke();this.ctx.scale(1/this.boxScale,1/this.boxScale);this.ctx.fillStyle="black";fontsize=.25*this.boxScale;this.ctx.font=System.String.format("{0}px Arial",[System.Double.format(fontsize,"G",System.Globalization.CultureInfo.invariantCulture)]);var left=Bridge.Int.clip32(Bridge.Math.round(1.45*this.boxScale,0,6)),top=Bridge.Int.clip32(Bridge.Math.round(.5*this.boxScale,0,6)),lines=System.String.split("Hello.\n\nThis tool can help you solve power-up panels. Open the selected field\nin-game and select the item you get in this app - repeat until the correct\nboard is found (and shown).\n\nUse the bullet to undo a step and POW to reset the board.\n\nIf the icons turn grey no solution was found.",[10].map(function(i){return String.fromCharCode(i)})),lineheight=Bridge.Int.clip32(Bridge.Math.round(.3*this.boxScale,0,6));for(i=0;i<lines.length;i=i+1|0)this.ctx.fillText(lines[System.Array.index(i,lines)],left,top+Bridge.Int.mul(lineheight,i)|0);this.ctx.restore()},DrawImage:function(img){img!=null&&(this.ctx.save(),img.TargetSize=Bridge.Int.clip32(Bridge.Math.round(this.boxScale*bitOxide.MarioWiiPowerup.Javascript.App.iconSize*2,0,6)),this.ctx.drawImage(img.ScaledImg,0,0,1,1),this.ctx.restore())},DrawButtonFill:function(color){bitOxide.MarioWiiPowerup.Javascript.CanvasContextExtension.RoundedRectPath(this.ctx,0,0,1,1,.2);this.ctx.fillStyle=color;this.ctx.fill()},DrawButtonBorder:function(color){color!=null&&(bitOxide.MarioWiiPowerup.Javascript.CanvasContextExtension.RoundedRectPath(this.ctx,0,0,1,1,.2),this.ctx.strokeStyle=color,this.ctx.lineWidth=.05,this.ctx.stroke())}}});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.CanvasContextExtension",{statics:{methods:{RoundedRectPath:function(ctx,x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y)}}}});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.CanvasDownscaleHelper",{statics:{methods:{DownscaleImage:function(img,scale){var nWidth=Bridge.Int.clip32(Bridge.Math.round(img.width*scale,0,6)),nHeight=Bridge.Int.clip32(Bridge.Math.round(img.height*scale,0,6)),imgCV=document.createElement("canvas"),imgCtx;return imgCV.width=img.width,imgCV.height=img.height,imgCtx=imgCV.getContext("2d"),imgCtx.drawImage(img,0,0),resample_single(imgCV,nWidth,nHeight,!0),imgCV},UpscaleImage:function(img,scale){var nWidth=Bridge.Int.clip32(Bridge.Math.round(img.width*scale,0,6)),nHeight=Bridge.Int.clip32(Bridge.Math.round(img.height*scale,0,6)),imgCV=document.createElement("canvas"),imgCtx;return imgCV.width=nWidth,imgCV.height=nHeight,imgCtx=imgCV.getContext("2d"),imgCtx.drawImage(img,0,0,nWidth,nHeight),imgCV},ScaleImage:function(img,scale){if(scale<=0){var imgCV=document.createElement("canvas");return imgCV.width=0,imgCV.height=0,imgCV}return scale<1?bitOxide.MarioWiiPowerup.Javascript.CanvasDownscaleHelper.DownscaleImage(img,scale):bitOxide.MarioWiiPowerup.Javascript.CanvasDownscaleHelper.UpscaleImage(img,scale)}}}});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.ItemImageStore",{statics:{methods:{GetDefault:function(){var iis=new bitOxide.MarioWiiPowerup.Javascript.ItemImageStore;return iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Bowser,"img/bowser.png",!0),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.MiniBowser,"img/minibowser.png",!0),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.FireFlower,"img/fireflower.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Fly,"img/fly.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.IceFlower,"img/iceflower.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Mini,"img/mini.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Mushroom,"img/mushroom.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Penguin,"img/penguin.png"),iis.RegisterIcon(bitOxide.MarioWiiPowerup.Core.Item.Star,"img/star.png"),iis.RegisterIcon$1("bullet","img/bullet.png"),iis.RegisterIcon$1("question","img/questionmark.png"),iis.RegisterIcon$1("pow","img/pow.png"),iis.RegisterIcon$1("win","img/win.png"),iis}}},fields:{itemImages:null},props:{LoadCompleted:{get:function(){var $t,v;$t=Bridge.getEnumerator(this.itemImages.getValues(),bitOxide.MarioWiiPowerup.Javascript.ScaledImage);try{while($t.moveNext())if(v=$t.Current,!v.Complete)return!1}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$dispose()}return!0}}},ctors:{init:function(){this.itemImages=new(System.Collections.Generic.Dictionary$2(System.String,bitOxide.MarioWiiPowerup.Javascript.ScaledImage))},ctor:function(){this.$initialize()}},methods:{GetIcon:function(item){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(item,null)?null:this.itemImages.get(item.Name)},GetIcon$1:function(name){return name==null?null:this.itemImages.get(name)},RegisterIcon:function(item,imageUrl,blackBg){blackBg===void 0&&(blackBg=!1);this.RegisterIcon$1(item.Name,imageUrl,blackBg)},RegisterIcon$1:function(name,imageUrl,blackBg){var $t,si;blackBg===void 0&&(blackBg=!1);si=new bitOxide.MarioWiiPowerup.Javascript.ScaledImage(($t=new Image,$t.src=imageUrl,$t),blackBg);this.itemImages.add(name,si)}}});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.Program",{statics:{fields:{canvas:null},ctors:{init:function(){Bridge.ready(this.Main)}},methods:{Main:function(){bitOxide.MarioWiiPowerup.Javascript.Program.ResetBrowserFrame();bitOxide.MarioWiiPowerup.Javascript.Program.canvas=document.createElement("canvas");document.body.appendChild(bitOxide.MarioWiiPowerup.Javascript.Program.canvas);var app=new bitOxide.MarioWiiPowerup.Javascript.App(bitOxide.MarioWiiPowerup.Javascript.Program.canvas);app.ResizeCalc();app.Draw();init_serviceworker();window.addEventListener("resize",function(){app.ResizeCalc();app.Draw()})},ResetBrowserFrame:function(){document.body.style.margin="0";document.body.style.padding="0";document.body.style.height="100%";document.body.style.overflow="hidden"}}},$entryPoint:!0});Bridge.define("bitOxide.MarioWiiPowerup.Javascript.ScaledImage",{fields:{image:null,blackBg:!1,targetSize:null,scaledImage:null},props:{TargetSize:{get:function(){return System.Nullable.getValue(this.targetSize)},set:function(value){if(System.Nullable.neq(value,this.targetSize)){var scale=value/this.image.width;this.scaledImage=bitOxide.MarioWiiPowerup.Javascript.CanvasDownscaleHelper.ScaleImage(this.image,scale);this.targetSize=value}}},BlackBackground:{get:function(){return this.blackBg}},Complete:{get:function(){return this.image.complete}},ScaledImg:{get:function(){return this.scaledImage}}},ctors:{ctor:function(image,blackBg){this.$initialize();this.image=image;this.blackBg=blackBg;this.targetSize=image.width}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.BoardCollection",{inherits:[System.Collections.Generic.IEnumerable$1(bitOxide.MarioWiiPowerup.Core.Board)],fields:{boards:null},props:{Count:{get:function(){return this.boards.length}}},alias:["getEnumerator",["System$Collections$Generic$IEnumerable$1$bitOxide$MarioWiiPowerup$Core$Board$getEnumerator","System$Collections$Generic$IEnumerable$1$getEnumerator"]],ctors:{ctor:function(boards){if(this.$initialize(),boards==null)throw new System.ArgumentNullException;this.boards=System.Linq.Enumerable.from(boards).toArray()}},methods:{getItem:function(Index){return this.boards[System.Array.index(Index,this.boards)]},getEnumerator:function(){var $step=0,$t,b,$async_e,$enumerator=new(Bridge.GeneratorEnumerator$1(bitOxide.MarioWiiPowerup.Core.Board))(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:$t=Bridge.getEnumerator(this.boards);$step=1;continue;case 1:if($t.moveNext()){b=$t.Current;$step=2;continue}$step=4;continue;case 2:return $enumerator.current=b,$step=3,!0;case 3:$step=1;continue;case 4:default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator},System$Collections$IEnumerable$getEnumerator:function(){return Bridge.getEnumerator(this.boards)}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.FindSolutionWithLeastInputs",{inherits:[bitOxide.MarioWiiPowerup.Core.Strategies.ISuggestionStrategy],alias:["SuggestNextItemPosition","bitOxide$MarioWiiPowerup$Core$Strategies$ISuggestionStrategy$SuggestNextItemPosition"],methods:{SuggestNextItemPosition:function(boards,filledItems){var allMatchingBoards=System.Linq.Enumerable.from(boards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,filledItems)}).toArray(bitOxide.MarioWiiPowerup.Core.Board),i;if(allMatchingBoards.length<=1)return null;var bowserProp=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetGoodPositionScore(allMatchingBoards),duplicates=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetDiversityScore(allMatchingBoards),instantLose=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInstantLoseScore(allMatchingBoards,filledItems),nonOpen=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetNonOpenPositions(filledItems),props=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.MergeScores([nonOpen,instantLose,duplicates]),maxProp=-1,curPos=-1;for(i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)props[System.Array.index(i,props)]>maxProp&&(maxProp=props[System.Array.index(i,props)],curPos=i);return curPos}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.FindSolutionWithLeastInputs2",{inherits:[bitOxide.MarioWiiPowerup.Core.Strategies.ISuggestionStrategy],alias:["SuggestNextItemPosition","bitOxide$MarioWiiPowerup$Core$Strategies$ISuggestionStrategy$SuggestNextItemPosition"],methods:{SuggestNextItemPosition:function(boards,filledItems){var allMatchingBoards=System.Linq.Enumerable.from(boards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,filledItems)}).toArray(bitOxide.MarioWiiPowerup.Core.Board),i;if(allMatchingBoards.length<=1)return null;var duplicates=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInformationContent(allMatchingBoards),instantLose=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInstantLoseScore(allMatchingBoards,filledItems),nonOpen=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetNonOpenPositions(filledItems),props=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.MergeScores([nonOpen,instantLose,duplicates]),maxProp=-1,curPos=-1;for(i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)props[System.Array.index(i,props)]>maxProp&&(maxProp=props[System.Array.index(i,props)],curPos=i);return curPos}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.FindSolutionWithLeastInputs3",{inherits:[bitOxide.MarioWiiPowerup.Core.Strategies.ISuggestionStrategy],alias:["SuggestNextItemPosition","bitOxide$MarioWiiPowerup$Core$Strategies$ISuggestionStrategy$SuggestNextItemPosition"],methods:{SuggestNextItemPosition:function(boards,filledItems){var allMatchingBoards=System.Linq.Enumerable.from(boards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,filledItems)}).toArray(bitOxide.MarioWiiPowerup.Core.Board),i;if(allMatchingBoards.length<=1)return null;var duplicates=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInformationContent(allMatchingBoards),bowserPenality=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetBowserFieldPenalty(allMatchingBoards),instantLose=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInstantLoseScore(allMatchingBoards,filledItems),nonOpen=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetNonOpenPositions(filledItems),props=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.MergeScores([nonOpen,instantLose,duplicates,bowserPenality]),maxProp=-1,curPos=-1;for(i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)props[System.Array.index(i,props)]>maxProp&&(maxProp=props[System.Array.index(i,props)],curPos=i);return curPos}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.Strategies.FindSolutionWithLeastInputs4",{inherits:[bitOxide.MarioWiiPowerup.Core.Strategies.ISuggestionStrategy],alias:["SuggestNextItemPosition","bitOxide$MarioWiiPowerup$Core$Strategies$ISuggestionStrategy$SuggestNextItemPosition"],methods:{SuggestNextItemPosition:function(boards,filledItems,lastPosition){var allMatchingBoards=System.Linq.Enumerable.from(boards).where(function(x){return bitOxide.MarioWiiPowerup.Core.BoardExtensions.Matches(x,filledItems)}).toArray(bitOxide.MarioWiiPowerup.Core.Board),i;if(allMatchingBoards.length<=1)return null;if(System.Linq.Enumerable.from(filledItems).all(function(i){return bitOxide.MarioWiiPowerup.Core.Item.op_Equality(i,null)}))return 14;var duplicates=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInformationContent(allMatchingBoards),bowserPenality=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetBowserFieldPenalty2(allMatchingBoards),instantLose=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetInstantLoseScore(allMatchingBoards,filledItems),nonOpen=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetNonOpenPositions(filledItems),distance=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.GetDistanceFactors(lastPosition),props=bitOxide.MarioWiiPowerup.Core.Strategies.BoardScoreExtensions.MergeScores([nonOpen,instantLose,duplicates,bowserPenality,distance]),maxProp=-1,curPos=-1;for(i=0;i<bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.ItemsPerBoard;i=i+1|0)props[System.Array.index(i,props)]>maxProp&&(maxProp=props[System.Array.index(i,props)],curPos=i);return curPos}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.WorldBoardCollection",{inherits:[bitOxide.MarioWiiPowerup.Core.BoardCollection],ctors:{ctor:function(boards){if(boards===void 0&&(boards=[]),this.$initialize(),bitOxide.MarioWiiPowerup.Core.BoardCollection.ctor.call(this,boards),boards.length!==bitOxide.MarioWiiPowerup.Core.SuperMarioWiiConstants.BoardsPerWorld)throw new System.IndexOutOfRangeException;}}});Bridge.define("bitOxide.MarioWiiPowerup.Core.GlobalBoardCollection",{inherits:[System.Collections.Generic.IEnumerable$1(bitOxide.MarioWiiPowerup.Core.WorldBoardCollection)],fields:{worldBoards:null},props:{Count:{get:function(){return 9}},AllBoards:{get:function(){return new(Bridge.GeneratorEnumerable$1(bitOxide.MarioWiiPowerup.Core.Board))(Bridge.fn.bind(this,function(){var $step=0,$t,world,$t1,board,$async_e,$enumerator=new(Bridge.GeneratorEnumerator$1(bitOxide.MarioWiiPowerup.Core.Board))(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:$t=Bridge.getEnumerator(this.worldBoards);$step=1;continue;case 1:if($t.moveNext()){world=$t.Current;$step=2;continue}$step=7;continue;case 2:$t1=Bridge.getEnumerator(world);$step=3;continue;case 3:if($t1.moveNext()){board=$t1.Current;$step=4;continue}$step=6;continue;case 4:return $enumerator.current=board,$step=5,!0;case 5:$step=3;continue;case 6:$step=1;continue;case 7:default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator}))}}},alias:["getEnumerator",["System$Collections$Generic$IEnumerable$1$bitOxide$MarioWiiPowerup$Core$WorldBoardCollection$getEnumerator","System$Collections$Generic$IEnumerable$1$getEnumerator"]],ctors:{ctor:function(worldBoards){if(this.$initialize(),worldBoards==null||worldBoards.length!==9)throw new System.ArgumentOutOfRangeException;this.worldBoards=Bridge.cast(System.Array.clone(worldBoards),System.Array.type(bitOxide.MarioWiiPowerup.Core.WorldBoardCollection))}},methods:{getItem:function(worldIndex){return this.worldBoards[System.Array.index(worldIndex,this.worldBoards)]},getEnumerator:function(){var $step=0,$t,wbc,$async_e,$enumerator=new(Bridge.GeneratorEnumerator$1(bitOxide.MarioWiiPowerup.Core.WorldBoardCollection))(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:$t=Bridge.getEnumerator(this.worldBoards);$step=1;continue;case 1:if($t.moveNext()){wbc=$t.Current;$step=2;continue}$step=4;continue;case 2:return $enumerator.current=wbc,$step=3,!0;case 3:$step=1;continue;case 4:default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator},System$Collections$IEnumerable$getEnumerator:function(){return this.getEnumerator()}}})});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICJiaXRPeGlkZS5NYXJpb1dpaVBvd2VydXAuSmF2YXNjcmlwdC5taW4uanMiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiIiwKICAic291cmNlc0NvbnRlbnQiOiBbXQp9Cg==
